meta:
  id: "feat_cli_structure"
  type: "Feature"
  domain: "dom_cli"
  status: "DONE"
  realized_by:
    - "comp_cli"

intent:
  summary: "重构为标准 Python CLI 项目结构"
  user_story: "作为开发者，我希望将单文件脚本重构为模块化的 Python 包，以便通过 `devspec` 命令调用，而不是 `python bootstrap.py`。"

contract:
  input: "None (Internal Refactor)"
  output: "A working `devspec` CLI with `init` and `generate` commands."

workflow:
  - step: 1
    name: "Package Structure"
    desc: "Create `devspec/main.py` (entry point), `devspec/core/loader.py` (yaml logic), `devspec/core/context.py` (prompt logic)."
  
  - step: 2
    name: "Typer App"
    desc: "Setup main Typer app in `main.py` with sub-commands."
  
  - step: 3
    name: "Migrate Bootstrap"
    desc: "Move the logic from `bootstrap.py` into the new structure as the `devspec generate` command."
  
  - step: 4
    name: "Add Init Command"
    desc: "Implement `devspec init` which creates the `.specgraph` directory structure if it doesn't exist."

  - step: 5
    name: "Interactive Init"
    desc: |
      Enhance `devspec init` with interactive project information collection:
      1. Check if product.yaml exists (skip if exists without --force)
      2. Create directory structure: design/, substrate/, features/, apis/, components/, datamodels/, .runtime/
      3. Prompt user for: project name, vision, domains, AI CLI choice (Claude/Gemini)
      4. Generate .specgraph/product.yaml with collected info
      5. Generate .specgraph/AGENT.md (full AI protocol guide)
      6. Generate CLAUDE.md or GEMINI.md in project root (short pointer to AGENT.md)
      7. Initialize SQLite database in .runtime/